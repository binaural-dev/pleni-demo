<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="price_bs_2" inherit_id="payment.payment_tokens_list">
        <xpath expr="//span[@class='payment_option_name']" position="after">
            <t t-set="exchange" t-value="website_sale_order.currency_bs_rate * website_sale_order.amount_total" />
            <input type="hidden" class="price_bs_input" t-att-value="exchange"/>
            <style>
                .tag-price-bs {
                    padding-right: 0.6em;
                    padding-left: 0.6em;
                    border-radius: 10rem;
                    color: #212529;
                    background-color: #ffc107;
                }
            </style>
            <script type="text/javascript">
                Array.from(document.getElementsByClassName("payment_option_name")).forEach( element => {
                    if (['Pago Móvil', 'Punto de Venta','Transferencia Bancaria (Bs)'].includes(element.textContent.trim().split('\n')[0])) {
                        let priceFloat = parseFloat(document.getElementsByClassName("price_bs_input")[0].value).toFixed(2)
                        if (!element.innerHTML.includes(priceFloat)) {
                            element.innerHTML = element.innerHTML + ' ' +  '<span class="tag-price-bs"><b>Bs. </b>' + '<b>' + priceFloat + '</b></span>'
                        }
                    }
                })
            </script>
        </xpath>
    </template>
	<template id="custom_payments_template" inherit_id="website_sale.payment">
        <xpath expr="//div[hasclass('oe_cart')]/div[hasclass('card')]" position="after">
			<div class="card mt-5" id="delivery_date_div">
                <div class="card-header text-white" style="background-color: #E4AE25; font-size: 14px; font-weight:bold">
                    2) Detalle de entrega
                </div>
                <div class="card-body" id="delivery_date_client_notes">  
                    <div class="row">      
                        <div class="col-lg-4">
                            <div><b>Fecha de Entrega:</b></div>
                            <input id="delivery_date" type="date" name="delivery_date" class="form-control o_website_form_input o_website_form_date address-inline"/>
                        </div>
                        <div class="col-lg-4">
                            <div><b> Bloque horario de preferencia:</b></div>
                            <select id="delivery_hour" name="delivery_hour" class="form-control s_website_form_input">
                                <option value="am" selected="True">AM</option>
                                <option value="pm">PM</option>
                            </select>
                        </div>
                    </div>
                    <div class="row pt-3">      
                        <div class="col-lg-12">
                            <div><b>Consideraciones con respecto a hora de entrega:</b></div>
                            <textarea id="client_notes" type="text" class="form-control s_website_form_input" name="client_notes"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <script type="text/javascript">
                let today  = new Date();
                let tomorrow = today.setDate(today.getDate() + 1);
                let tomorrow_date = new Date(tomorrow).toISOString().split('T')[0];

                document.getElementsByName("delivery_date")[0].setAttribute('min', tomorrow_date);
                document.getElementsByName("delivery_date")[0].value = tomorrow_date
            </script>
        </xpath>

        <xpath expr="//div[hasclass('oe_cart')]/div[@id='payment_method']/h3[1]" position="replace">
            <div class="card-header text-white mt-5" style="background-color: #E4AE25; font-size: 14px; font-weight:bold">
                3) Métodos de pago
            </div>
            <style>
                .text-muted.ml-3 {
                    height: 5px;
                }

                form .card {
                    margin-bottom: 20px;
                }
            </style>
        </xpath>

        <xpath expr="//div[hasclass('oe_cart')]/div[@class='card']/div[1]" position="before">
            <div class="card-header text-white" style="background-color: #E4AE25; font-size: 14px; font-weight:bold">
                1) Facturación y Envío
            </div>
        </xpath>

    </template>

</odoo>